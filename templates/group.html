<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>LinkSea Group - {{ group_name }}</title>
        <link rel="stylesheet" href="static/css/group.css" />
    </head>

    <body>
        <div class="container">
            <div class="group-header">
                <h1>
                    <span id="group-title">{{ group_name }}</span>
                    <span class="edit-icon" onclick="toggleRenameForm()">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            style="
                                width: 0.5em;
                                height: 0.5em;
                                vertical-align: middle;
                                fill: #777;
                            "
                        >
                            <path
                                d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"
                            />
                        </svg>
                    </span>
                </h1>
                <div class="group-id-container">
                    <span class="group-id">ID: {{ group_id }}</span>
                    <button
                        class="copy-button"
                        onclick="copyGroupId('{{ group_id }}')"
                    >
                        Copy ID
                    </button>
                </div>
            </div>

            <div id="rename-group-form" class="rename-form">
                <form
                    method="POST"
                    action="{{ url_for('rename_group', group_id=group_id) }}"
                >
                    <label for="group_name">New Name:</label>
                    <input
                        type="text"
                        id="group_name"
                        name="group_name"
                        value=""
                        required
                    />
                    <button type="submit">Rename</button>
                </form>
            </div>

            <div class="group-info">
                <p>
                    Share this URL to collaborate:
                    <code>http://localhost:5000/{{ group_id }}</code>
                </p>
            </div>

            <h2>Add New Link</h2>
            <form
                class="add-link-form"
                method="POST"
                action="{{ url_for('add_link', group_id=group_id) }}"
            >
                <div>
                    <label for="url">Link URL:</label>
                    <input
                        type="url"
                        id="url"
                        name="url"
                        placeholder="https://example.com"
                        required
                    />
                </div>
                <div>
                    <label for="note">Note (Optional):</label>
                    <input
                        type="text"
                        id="note"
                        name="note"
                        placeholder="Short description"
                    />
                </div>
                <button type="submit">Add Link</button>
            </form>

            <h2>Links</h2>
            {% if links %}
            <ul class="link-list">
                {% for link in links %}
                <li
                    class="link-item"
                    draggable="true"
                    data-link-id="{{ link.id }}"
                >
                    <div class="link-details">
                        {% if link.favicon %}
                        <img src="{{ link.favicon }}" alt=" " />
                        {% endif %}
                        <a href="{{ link.url }}" target="_blank">
                            {{ link.title }}
                        </a>
                        {% if link.title == link.url %}
                        <span class="note">(Title not available)</span>
                        {% endif %} {% if link.note %}
                        <span class="note">{{ link.note }}</span>
                        {% endif %}
                    </div>
                    <div class="link-actions">
                        <button
                            type="button"
                            onclick="toggleLinkEditForm('{{ link.id }}')"
                        >
                            Edit Title
                        </button>
                        <form
                            method="POST"
                            action="{{ url_for('remove_link', group_id=group_id, link_id=link.id) }}"
                            style="display: inline"
                        >
                            <button type="submit">Remove</button>
                        </form>
                    </div>

                    <form
                        id="edit-link-form-{{ link.id }}"
                        class="edit-link-form"
                        method="POST"
                        action="{{ url_for('edit_link', group_id=group_id, link_id=link.id) }}"
                    >
                        <label for="title">Edit Title:</label>
                        <input
                            type="text"
                            id="title"
                            name="title"
                            value="{{ link.title }}"
                            required
                        />
                        <button type="submit">Update</button>
                    </form>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="no-links">No links in this group yet. Add one above!</p>
            {% endif %}

            <a href="{{ url_for('index') }}" class="home-link">
                ‚Üê Back to Home / Create New Group</a
            >
        </div>

        <div id="toast-container">
            <div id="copy-toast" class="toast">
                Group ID copied to clipboard!
            </div>
        </div>

        <script src="static/js/group.js"></script>
    </body>
</html>
